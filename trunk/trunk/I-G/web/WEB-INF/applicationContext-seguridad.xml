<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns:p="http://www.springframework.org/schema/p"
   xmlns:sec="http://www.springframework.org/schema/security"
   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
                             http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-2.0.2.xsd">
    <sec:http auto-config="true">
        <sec:intercept-url pattern="${excepcion.1}" filters="none" />
        <sec:intercept-url pattern="${excepcion.2}" filters="none" />
        <sec:intercept-url pattern="${excepcion.3}" filters="none" />
        <sec:intercept-url pattern="${excepcion.4}" filters="none" />
        <sec:intercept-url pattern="/**" access="ROLE_ADMIN,ROLE_USER"  />
        <sec:form-login login-page="${pagina.login}"
                        default-target-url="${pagina.principal}"
                        authentication-failure-url="${pagina.error.login}"
                        login-processing-url="${url.procesado.login}" />
    </sec:http>
    <sec:authentication-provider>
        <sec:user-service>
            <sec:user name="admin" password="admin"
            authorities="ROLE_USER,ROLE_ADMIN" />
            <sec:user name="usuario" password="usuario"
            authorities="ROLE_USER" />
        </sec:user-service>
    </sec:authentication-provider>
</beans>
